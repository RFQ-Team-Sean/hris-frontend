<div class="job-application-container">
  <div class="job-header">
    <h1>Job Application: {{ jobTitle }}</h1>
    <p class="job-id">Reference: {{ jobId }}</p>
  </div>

  <div class="form-progress">
    <div class="progress-bar">
      <div
        class="progress-fill"
        [style.width]="(currentStep / totalSteps) * 100 + '%'"
      ></div>
    </div>
    <div class="steps-container">
      <div class="step" [class.active]="currentStep >= 1">
        <div class="step-number">1</div>
        <div class="step-label">Personal Info</div>
      </div>
      <div class="step" [class.active]="currentStep >= 2">
        <div class="step-number">2</div>
        <div class="step-label">Education</div>
      </div>
      <div class="step" [class.active]="currentStep >= 3">
        <div class="step-number">3</div>
        <div class="step-label">Experience</div>
      </div>
      <div class="step" [class.active]="currentStep >= 4">
        <div class="step-number">4</div>
        <div class="step-label">Skills</div>
      </div>
      <div class="step" [class.active]="currentStep >= 5">
        <div class="step-number">5</div>
        <div class="step-label">Documents</div>
      </div>
    </div>
  </div>

  <div class="form-container">
    <!-- Step 1: Personal Information -->
    <div class="form-step" *ngIf="currentStep === 1">
      <h2>Personal Information</h2>
      <form [formGroup]="personalForm">
        <div class="form-grid">
          <div class="form-group">
            <label for="firstName"
              >First Name <span class="required">*</span></label
            >
            <input
              type="text"
              id="firstName"
              formControlName="firstName"
              class="form-control"
            />
          </div>

          <div class="form-group">
            <label for="middleName">Middle Name</label>
            <input
              type="text"
              id="middleName"
              formControlName="middleName"
              class="form-control"
            />
          </div>

          <div class="form-group">
            <label for="lastName"
              >Last Name <span class="required">*</span></label
            >
            <input
              type="text"
              id="lastName"
              formControlName="lastName"
              class="form-control"
            />
          </div>

          <div class="form-group">
            <label for="email">Email <span class="required">*</span></label>
            <input
              type="email"
              id="email"
              formControlName="email"
              class="form-control"
            />
          </div>

          <div class="form-group">
            <label for="phone"
              >Phone Number <span class="required">*</span></label
            >
            <input
              type="tel"
              id="phone"
              formControlName="phone"
              class="form-control"
            />
          </div>

          <div class="form-group full-width">
            <label for="address">Address <span class="required">*</span></label>
            <input
              type="text"
              id="address"
              formControlName="address"
              class="form-control"
            />
          </div>

          <div class="form-group">
            <label for="city">City <span class="required">*</span></label>
            <input
              type="text"
              id="city"
              formControlName="city"
              class="form-control"
            />
          </div>

          <div class="form-group">
            <label for="state"
              >State/Province <span class="required">*</span></label
            >
            <input
              type="text"
              id="state"
              formControlName="state"
              class="form-control"
            />
          </div>

          <div class="form-group">
            <label for="zipCode"
              >Zip/Postal Code <span class="required">*</span></label
            >
            <input
              type="text"
              id="zipCode"
              formControlName="zipCode"
              class="form-control"
            />
          </div>

          <div class="form-group">
            <label for="dateOfBirth">Date of Birth</label>
            <input
              type="date"
              id="dateOfBirth"
              formControlName="dateOfBirth"
              class="form-control"
            />
          </div>

          <div class="form-group checkbox-group">
            <label>
              <input type="checkbox" formControlName="isExistingEmployee" /> I
              am an existing employee
            </label>
          </div>
        </div>
      </form>
    </div>

    <!-- Step 2: Education Information -->
    <div class="form-step" *ngIf="currentStep === 2">
      <h2>Education Information</h2>
      <form [formGroup]="educationForm">
        <div class="form-grid">
          <div class="form-group">
            <label for="highestQualification"
              >Highest Qualification <span class="required">*</span></label
            >
            <select
              id="highestQualification"
              formControlName="highestQualification"
              class="form-control"
            >
              <option value="">Select</option>
              <option value="High School">High School</option>
              <option value="Associate's Degree">Associate's Degree</option>
              <option value="Bachelor's Degree">Bachelor's Degree</option>
              <option value="Master's Degree">Master's Degree</option>
              <option value="Doctorate">Doctorate</option>
              <option value="Other">Other</option>
            </select>
          </div>

          <div class="form-group">
            <label for="institution"
              >Institution <span class="required">*</span></label
            >
            <input
              type="text"
              id="institution"
              formControlName="institution"
              class="form-control"
            />
          </div>

          <div class="form-group">
            <label for="fieldOfStudy"
              >Field of Study <span class="required">*</span></label
            >
            <input
              type="text"
              id="fieldOfStudy"
              formControlName="fieldOfStudy"
              class="form-control"
            />
          </div>

          <div class="form-group">
            <label for="graduationYear"
              >Graduation Year <span class="required">*</span></label
            >
            <input
              type="number"
              id="graduationYear"
              formControlName="graduationYear"
              class="form-control"
              min="1950"
              max="2030"
            />
          </div>

          <div class="form-group">
            <label for="gpa">GPA</label>
            <input
              type="text"
              id="gpa"
              formControlName="gpa"
              class="form-control"
            />
          </div>
        </div>
      </form>
    </div>

    <!-- Step 3: Work Experience -->
    <div class="form-step" *ngIf="currentStep === 3">
      <h2>Work Experience</h2>
      <form [formGroup]="experienceForm">
        <div class="form-grid">
          <div class="form-group checkbox-group">
            <label>
              <input type="checkbox" formControlName="currentlyEmployed" />
              Currently Employed
            </label>
          </div>

          <div
            class="form-group"
            *ngIf="experienceForm.get('currentlyEmployed')?.value"
          >
            <label for="currentEmployer">Current Employer</label>
            <input
              type="text"
              id="currentEmployer"
              formControlName="currentEmployer"
              class="form-control"
            />
          </div>

          <div
            class="form-group"
            *ngIf="experienceForm.get('currentlyEmployed')?.value"
          >
            <label for="currentPosition">Current Position</label>
            <input
              type="text"
              id="currentPosition"
              formControlName="currentPosition"
              class="form-control"
            />
          </div>

          <div class="form-group">
            <label for="employmentType"
              >Preferred Employment Type <span class="required">*</span></label
            >
            <select
              id="employmentType"
              formControlName="employmentType"
              class="form-control"
            >
              <option value="">Select employment type</option>
              <option *ngFor="let type of employmentTypes" [value]="type">
                {{ type.replace("_", " ") }}
              </option>
            </select>
          </div>

          <div class="form-group full-width">
            <label for="workExperience"
              >Total Work Experience (in years)
              <span class="required">*</span></label
            >
            <input
              type="number"
              id="workExperience"
              formControlName="workExperience"
              class="form-control"
              min="0"
              max="50"
            />
          </div>

          <div class="form-group full-width">
            <label for="relevantExperience"
              >Relevant Experience <span class="required">*</span></label
            >
            <textarea
              id="relevantExperience"
              formControlName="relevantExperience"
              class="form-control textarea"
              rows="5"
              placeholder="Please describe your relevant experience for this position"
            ></textarea>
          </div>
        </div>
      </form>
    </div>

    <!-- Step 4: Skills -->
    <div class="form-step" *ngIf="currentStep === 4">
      <h2>Skills and Qualifications</h2>
      <form [formGroup]="skillsForm">
        <div class="form-grid">
          <div class="form-group full-width">
            <label for="skills">Skills <span class="required">*</span></label>
            <textarea
              id="skills"
              formControlName="skills"
              class="form-control textarea"
              rows="4"
              placeholder="List your key skills relevant to the position (e.g., Project Management, JavaScript, Agile)"
            ></textarea>
          </div>

          <div class="form-group full-width">
            <label for="languages">Languages</label>
            <input
              type="text"
              id="languages"
              formControlName="languages"
              class="form-control"
              placeholder="Languages you are proficient in (e.g., English, Spanish)"
            />
          </div>

          <div class="form-group full-width">
            <label for="certifications">Certifications</label>
            <textarea
              id="certifications"
              formControlName="certifications"
              class="form-control textarea"
              rows="3"
              placeholder="List any relevant certifications (e.g., PMP, AWS Certified, CCNA)"
            ></textarea>
          </div>
        </div>
      </form>
    </div>

    <!-- Step 5: Documents -->
    <div class="form-step" *ngIf="currentStep === 5">
      <h2>Documents</h2>
      <form [formGroup]="documentForm">
        <div class="form-grid">
          <div class="form-group full-width">
            <label for="resume"
              >Resume/CV <span class="required">*</span></label
            >
            <div class="file-upload">
              <input
                type="file"
                id="resume"
                class="file-input"
                (change)="onFileSelected($event, 'resume')"
                accept=".pdf,.doc,.docx"
              />
              <label for="resume" class="file-label">Choose File</label>
              <span class="file-name">{{
                resumeFileName || "No file chosen"
              }}</span>
            </div>
            <div
              class="error-message"
              *ngIf="
                documentForm.get('resume')?.invalid &&
                documentForm.get('resume')?.touched
              "
            >
              Resume is required
            </div>
            <p class="file-hint">
              Accepted formats: PDF, DOC, DOCX. Max size: 5MB
            </p>
          </div>

          <div class="form-group full-width">
            <label for="coverLetter">Cover Letter</label>
            <div class="file-upload">
              <input
                type="file"
                id="coverLetter"
                class="file-input"
                (change)="onFileSelected($event, 'coverLetter')"
                accept=".pdf,.doc,.docx"
              />
              <label for="coverLetter" class="file-label">Choose File</label>
              <span class="file-name">{{
                coverLetterFileName || "No file chosen"
              }}</span>
            </div>
            <p class="file-hint">
              Accepted formats: PDF, DOC, DOCX. Max size: 5MB
            </p>
          </div>

          <div class="form-group full-width">
            <label for="additionalDocuments">Additional Documents</label>
            <div class="file-upload">
              <input
                type="file"
                id="additionalDocuments"
                class="file-input"
                (change)="onFileSelected($event, 'additionalDocuments')"
                multiple
                accept=".pdf,.doc,.docx,.jpg,.png"
              />
              <label for="additionalDocuments" class="file-label"
                >Choose Files</label
              >
              <span class="file-name">{{
                additionalDocumentsCount
                  ? additionalDocumentsCount + " file(s) chosen"
                  : "No files chosen"
              }}</span>
            </div>
            <p class="file-hint">
              Accepted formats: PDF, DOC, DOCX, JPG, PNG. Max size: 10MB total
            </p>
          </div>

          <div class="form-group checkbox-group full-width">
            <label class="terms-checkbox">
              <input type="checkbox" formControlName="agreeTerms" /> I certify
              that all information provided is true and complete to the best of
              my knowledge.
            </label>
          </div>
        </div>
      </form>
    </div>

    <!-- Navigation Buttons -->
    <div class="form-navigation">
      <button
        class="btn btn-secondary"
        *ngIf="currentStep > 1"
        (click)="prevStep()"
      >
        Previous
      </button>
      <button
        class="btn btn-primary"
        *ngIf="currentStep < totalSteps"
        (click)="nextStep()"
        [disabled]="
          (currentStep === 1 && personalForm.invalid) ||
          (currentStep === 2 && educationForm.invalid) ||
          (currentStep === 3 && experienceForm.invalid) ||
          (currentStep === 4 && skillsForm.invalid)
        "
      >
        Next
      </button>
      <button
        class="btn btn-success"
        *ngIf="currentStep === totalSteps"
        (click)="onSubmit()"
        [disabled]="documentForm.invalid"
      >
        Submit Application
      </button>
    </div>
  </div>
</div>
